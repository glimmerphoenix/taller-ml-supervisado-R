<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Algoritmos y modelos – Aprendizaje máquina supervisado con R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-seleccion-validacion.html" rel="next">
<link href="./02-ml-supervisado.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-04e1f1103201cc0a83f720091ef4aae4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-introduccion.html">Fundamentos</a></li><li class="breadcrumb-item"><a href="./03-algoritmos-modelos.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Algoritmos y modelos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Aprendizaje máquina supervisado con R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-ml-supervisado.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Aprendizaje máquina supervisado</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-algoritmos-modelos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Algoritmos y modelos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-seleccion-validacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Selección y validación de modelos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Métodos convencionales</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-modelos-clasicos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelos clásicos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-modelos-avanzados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos avanzados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Tidymodels</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tidymodels</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Otros entornos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mlr3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">MLR3</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-add-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Recursos adicionales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Apéndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-command-ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Referencia de comandos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Paquetes R empleados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-refs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#datasets" id="toc-datasets" class="nav-link active" data-scroll-target="#datasets"><span class="header-section-number">3.1</span> Datasets</a>
  <ul class="collapse">
  <li><a href="#particionado-de-datos" id="toc-particionado-de-datos" class="nav-link" data-scroll-target="#particionado-de-datos"><span class="header-section-number">3.1.1</span> Particionado de datos</a></li>
  </ul></li>
  <li><a href="#k-vecinos-más-cercanos-k-nn" id="toc-k-vecinos-más-cercanos-k-nn" class="nav-link" data-scroll-target="#k-vecinos-más-cercanos-k-nn"><span class="header-section-number">3.2</span> K vecinos más cercanos (K-NN)</a>
  <ul class="collapse">
  <li><a href="#ajuste-de-un-modelo-de-clasificación-knn" id="toc-ajuste-de-un-modelo-de-clasificación-knn" class="nav-link" data-scroll-target="#ajuste-de-un-modelo-de-clasificación-knn"><span class="header-section-number">3.2.1</span> Ajuste de un modelo de clasificación KNN</a></li>
  </ul></li>
  <li><a href="#sec-linear-models" id="toc-sec-linear-models" class="nav-link" data-scroll-target="#sec-linear-models"><span class="header-section-number">3.3</span> Modelos lineales</a>
  <ul class="collapse">
  <li><a href="#ajuste-de-un-modelo-de-clasificación-lr" id="toc-ajuste-de-un-modelo-de-clasificación-lr" class="nav-link" data-scroll-target="#ajuste-de-un-modelo-de-clasificación-lr"><span class="header-section-number">3.3.1</span> Ajuste de un modelo de clasificación LR</a></li>
  <li><a href="#regularización-en-modelos-lineales" id="toc-regularización-en-modelos-lineales" class="nav-link" data-scroll-target="#regularización-en-modelos-lineales"><span class="header-section-number">3.3.2</span> Regularización en modelos lineales</a></li>
  </ul></li>
  <li><a href="#extensiones-del-modelo-lineal" id="toc-extensiones-del-modelo-lineal" class="nav-link" data-scroll-target="#extensiones-del-modelo-lineal"><span class="header-section-number">3.4</span> Extensiones del modelo lineal</a>
  <ul class="collapse">
  <li><a href="#ajuste-de-un-modelo-gam-para-clasificación" id="toc-ajuste-de-un-modelo-gam-para-clasificación" class="nav-link" data-scroll-target="#ajuste-de-un-modelo-gam-para-clasificación"><span class="header-section-number">3.4.1</span> Ajuste de un modelo GAM para clasificación</a></li>
  </ul></li>
  <li><a href="#máquinas-de-vector-soporte-svm" id="toc-máquinas-de-vector-soporte-svm" class="nav-link" data-scroll-target="#máquinas-de-vector-soporte-svm"><span class="header-section-number">3.5</span> Máquinas de vector soporte (SVM)</a>
  <ul class="collapse">
  <li><a href="#ajuste-de-un-modelo-svm-rbf" id="toc-ajuste-de-un-modelo-svm-rbf" class="nav-link" data-scroll-target="#ajuste-de-un-modelo-svm-rbf"><span class="header-section-number">3.5.1</span> Ajuste de un modelo SVM (RBF)</a></li>
  </ul></li>
  <li><a href="#modelos-probabilísticos-naïve-bayes" id="toc-modelos-probabilísticos-naïve-bayes" class="nav-link" data-scroll-target="#modelos-probabilísticos-naïve-bayes"><span class="header-section-number">3.6</span> Modelos probabilísticos: Naïve Bayes</a></li>
  <li><a href="#redes-neuronales-y-aprendizaje-profundo" id="toc-redes-neuronales-y-aprendizaje-profundo" class="nav-link" data-scroll-target="#redes-neuronales-y-aprendizaje-profundo"><span class="header-section-number">3.7</span> Redes neuronales y aprendizaje profundo</a></li>
  <li><a href="#ensamblado-de-modelos" id="toc-ensamblado-de-modelos" class="nav-link" data-scroll-target="#ensamblado-de-modelos"><span class="header-section-number">3.8</span> Ensamblado de modelos</a>
  <ul class="collapse">
  <li><a href="#ejemplo-de-ajuste-de-un-modelo-random-forests-rf" id="toc-ejemplo-de-ajuste-de-un-modelo-random-forests-rf" class="nav-link" data-scroll-target="#ejemplo-de-ajuste-de-un-modelo-random-forests-rf"><span class="header-section-number">3.8.1</span> Ejemplo de ajuste de un modelo Random Forests (RF)</a></li>
  <li><a href="#ejemplo-de-ajuste-de-un-modelo-adaboost" id="toc-ejemplo-de-ajuste-de-un-modelo-adaboost" class="nav-link" data-scroll-target="#ejemplo-de-ajuste-de-un-modelo-adaboost"><span class="header-section-number">3.8.2</span> Ejemplo de ajuste de un modelo AdaBoost</a></li>
  <li><a href="#ejemplo-de-ajuste-de-modelos-xgboost" id="toc-ejemplo-de-ajuste-de-modelos-xgboost" class="nav-link" data-scroll-target="#ejemplo-de-ajuste-de-modelos-xgboost"><span class="header-section-number">3.8.3</span> Ejemplo de ajuste de modelos XGBoost</a></li>
  </ul></li>
  <li><a href="#apilado-de-modelos" id="toc-apilado-de-modelos" class="nav-link" data-scroll-target="#apilado-de-modelos"><span class="header-section-number">3.9</span> Apilado de modelos</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-introduccion.html">Fundamentos</a></li><li class="breadcrumb-item"><a href="./03-algoritmos-modelos.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Algoritmos y modelos</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Algoritmos y modelos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>En este apartado, vamos a presentar algunos modelos de aprendizaje máquina supervisado que, posteriormente, mostraremos cómo se pueden entrenar y evaluar con R. Necesitaremos los siguientes paquetes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlbench)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Además, será necesario tener instalados varios paquetes más que <code>caret</code> emplea internamente para ajustar cada tipo de algoritmo o modelo solicitado.</p>
<div id="tbl-pkgs-chap3" class="striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pkgs-chap3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;3.1: Paquetes R necesarios para ejecutar los ejemplos de este capítulo.
</figcaption>
<div aria-describedby="tbl-pkgs-chap3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Paquete</th>
<th style="text-align: left;">Modelo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>stepPlr</code></td>
<td style="text-align: left;">Reg. Logística penalizada</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>adabag</code></td>
<td style="text-align: left;">Adaboost</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mgcv</code></td>
<td style="text-align: left;">GAM</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>gam</code></td>
<td style="text-align: left;">GAM</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>xgboost</code></td>
<td style="text-align: left;">XGBoost</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>randomForest</code></td>
<td style="text-align: left;">Random Forests</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>kernlab</code></td>
<td style="text-align: left;">SVM</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Antes de comenzar, es importante hacer una distinción entre dos tipos de modelos o algoritmos <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>:</p>
<ul>
<li><p><strong>Modelos paramétricos</strong>: son aquellos en los que se utiliza una función <span class="math inline">\(f(X)\)</span> para predecir la salida, cuya forma viene determinada por una serie de parámetros que podemos ajustar a partir de los datos. Un ejemplo sería un modelo de regresión lineal.</p></li>
<li><p><strong>Modelos no paramétricos</strong>: estos no asumen una forma paramétrica para la función de predicción <span class="math inline">\(f(X)\)</span>, ofreciendo una alternativa más flexible para resolver el problema de regresión.</p></li>
</ul>
<p>En este capítulo vamos a utilizar el paquete <code>caret</code> en modo de ejecución paralela, para aprovechar las capacidades multi-núcleo de la mayoría de computadores modernos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makePSOCKcluster</span>(<span class="dv">5</span>) <span class="co"># 5 cores para proc. paralelo</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="datasets" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="datasets"><span class="header-section-number">3.1</span> Datasets</h2>
<p><strong>Dataset: <code>Sonar</code></strong>: El objetivo es discriminar entre dos tipos de blancos detectados con un sistema sónar <span class="citation" data-cites="gorman1988">(<a href="references.html#ref-gorman1988" role="doc-biblioref">Gorman &amp; Sejnowski, 1988</a>)</span>:</p>
<ul>
<li>Cilindro metálico.</li>
<li>Roca aproximadamente cilíndrica.</li>
</ul>
<p>Está incluido en el paquete <code>mlbench</code> <span class="citation" data-cites="leisch2024mlbench">Blake &amp; Merz (<a href="references.html#ref-UCI1998" role="doc-biblioref">1998</a>)</span>.</p>
<div id="tbl-desc-Sonar" class="striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-desc-Sonar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;3.2: Descripción del dataset <code>mlbench::Sonar</code>.
</figcaption>
<div aria-describedby="tbl-desc-Sonar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Descripción</th>
<th style="text-align: left;">Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tipo de problema</td>
<td style="text-align: left;">Clasificación binaria (supervisada)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Respuesta</td>
<td style="text-align: left;"><code>Class</code>; etiquetas: <code>M</code> o <code>R</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variables (<em>inputs</em>)</td>
<td style="text-align: left;">60; rango <span class="math inline">\([0.0, 1.0]\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Observaciones</td>
<td style="text-align: left;">208</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Objetivo</td>
<td style="text-align: left;">Distinguir tipo de blanco sónar</td>
</tr>
<tr class="even">
<td style="text-align: left;">Más información</td>
<td style="text-align: left;"><code>?mlbench::Sonar</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="particionado-de-datos" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="particionado-de-datos"><span class="header-section-number">3.1.1</span> Particionado de datos</h3>
<p><strong>Dataset: <code>mlbench::Sonar</code></strong>.</p>
<p>La preparación esta <a href="https://cran.r-project.org/web/packages/caret/vignettes/caret.html">documentada en el paquete <code>caret</code></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Sonar)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>SonarData <span class="ot">=</span> Sonar[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">11</span>,<span class="dv">17</span>,<span class="dv">23</span>,<span class="dv">28</span>,<span class="dv">34</span>,<span class="dv">40</span>,<span class="dv">45</span>,<span class="dv">56</span>,<span class="dv">61</span>)]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> SonarData<span class="sc">$</span>Class,  <span class="co"># se necesitan los datos de la salida</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> .<span class="dv">75</span>,              <span class="co"># 75% datos para entrenamiento</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">list =</span> <span class="cn">FALSE</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Formato de resultados</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="do">## La salidad es un conjunto de enteros que representan los</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="do">## índices de las filas en el dataset original escogidos para</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="do">## entrar en el training set.</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(inTrain)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:157, 1] 1 2 3 4 5 7 10 11 12 13 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr "Resample1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> SonarData[ inTrain,]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>testing  <span class="ot">&lt;-</span> SonarData[<span class="sc">-</span>inTrain,]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(training)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(testing)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51</code></pre>
</div>
</div>
<p>Sólo queda configurar es sistema de evaluación cruzada para medir el rendimiento de los modelos antes de enfrentarse al conjunto final de prueba, así como para ajustar los hiperparámetros que sean necesarios. En todos los ejemplos aplicaremos validación cruzada con 5 grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>config_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'cv'</span>,                   <span class="co"># k-fold cross-validation</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># method = 'repeatedcv',         # k-fold cross-validation repetida (variante)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">number =</span> <span class="dv">5</span>,                      <span class="co"># número de grupos o iteraciones de remuestreo</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># repeats = 10,                  # número de conjuntos completos de grupos a computar</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">savePredictions =</span> <span class="st">'final'</span>,       <span class="co"># guardar las predicciones para ajuste óptimo de hiperparámetros</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">classProbs =</span> <span class="cn">TRUE</span>,               <span class="co"># se devuelven las probabilidades de clase</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">summaryFunction=</span>twoClassSummary  <span class="co"># tipo de función para resumir resultados (según el tipo de problema)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="k-vecinos-más-cercanos-k-nn" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="k-vecinos-más-cercanos-k-nn"><span class="header-section-number">3.2</span> K vecinos más cercanos (K-NN)</h2>
<p>Se trata de un modelo que puede realizar funciones de regresión o clasificación. En el caso de la <strong>regresión</strong>, fijado un valor para <span class="math inline">\(K\)</span> y un punto de predicción <span class="math inline">\(x_0\)</span>, se identifican las <span class="math inline">\(K\)</span> observaciones del conjunto de entrenamiento más cercanas a <span class="math inline">\(x_0\)</span>, denotadas por <span class="math inline">\(\mathcal{N}_0\)</span>. Entonces, se estima <span class="math inline">\(f(x_0)\)</span> como el valor promedio de todas las respuestas contenidas en <span class="math inline">\(\mathcal{N}_0\)</span>, es decir:</p>
<p><span id="eq-KNN-reg"><span class="math display">\[
\hat{f}(x_0) = \frac{1}{K}\sum_{x_i \in \mathcal{N}_0} \,y_i.
\tag{3.1}\]</span></span></p>
<div id="fig-KNN-fit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-KNN-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/KNN-fit-ISLRv2.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-KNN-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.1: Valores estimados para una regresión KNN en un conjunto de datos en dos dimensiones con 64 observaciones. Izq.: K=1. Dcha.: K=9. Fuente: Fig. 3.16 <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>.
</figcaption>
</figure>
</div>
<p>Este modelo se basa en la premisa de que las observaciones similares se encontrarán próximas entre sí dentro del espacio de representación de los datos. Sin embargo, no siempre es fácil encontrar espacios de representación que describan nuestro problema de forma adecuada para que se cumpla esta premisa. En todo caso, este modelo ha demostrado ser muy útil en gran variedad de problemas.</p>
<p>En la <a href="https://bradleyboehmke.github.io/HOML/knn.html#measuring-similarity">Sec. 8.2</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>, se discuten algunas medidas de disimilaridad que se pueden computar entre pares de observaciones. Algunas funciones de distancia son la familia de distancias Minkowski, incluyendo Manhattan (L1), Euclídea (L2) o Chebyshev (Linf); la distancia de Haversine (para datos geolocalizados sobre la superficie terrestre); la similaridad del coseno (para documentos o datos textuales) o la distancia de Jaccard.</p>
<p>El modelo KNN para <strong>clasificación</strong> es muy directo. Sea <span class="math inline">\(K\)</span> un número entero positivo y <span class="math inline">\(x_0\)</span> una observación que deseamos clasificar. Primero, el algoritmo identifica las <span class="math inline">\(K\)</span> observaciones más cercanas a <span class="math inline">\(x_0\)</span>, que denotamos por <span class="math inline">\(\mathcal{N}_0\)</span>. Entonces, se estima la probabilidad condicional para la clase <span class="math inline">\(j\)</span> como la fracción de puntos pertenecientes a <span class="math inline">\(\mathcal{N}_0\)</span> cuyos valores de respuesta son la clase <span class="math inline">\(j\)</span>. En otras palabras, se asigna la etiqueta de salida de la mayorí ade vecinos cercanos como la clase más probable para la salida a predecir para el punto <span class="math inline">\(x_0\)</span>:</p>
<p><span id="eq-KNN-class"><span class="math display">\[
P(Y=j \mid X=x_0)= \frac{1}{K}\sum_{i \in \mathcal{N}_0} \,I(y_i = j).
\tag{3.2}\]</span></span></p>
<section id="ajuste-de-un-modelo-de-clasificación-knn" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="ajuste-de-un-modelo-de-clasificación-knn"><span class="header-section-number">3.2.1</span> Ajuste de un modelo de clasificación KNN</h3>
<p>En el siguiente ejemplo se muestra cómo ajustar un modelo KNN para clasificación con el dataset <code>mlbench::Sonar</code>. La métrica que emplearemos para ajustar el hiperparámetro <span class="math inline">\(K\)</span> es la curva ROC, presentada en la <a href="04-seleccion-validacion.html#sec-eval-classification" class="quarto-xref"><span>Sección 4.2.2</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model_knn <span class="ot">=</span> <span class="fu">train</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>training, <span class="at">method=</span><span class="st">'knn'</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric=</span><span class="st">"ROC"</span>, <span class="at">trControl =</span> config_control)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>model_knn</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

157 samples
  9 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 126, 126, 126, 125, 125 
Resampling results across tuning parameters:

  k  ROC        Sens       Spec     
  5  0.8092927  0.8213235  0.6733333
  7  0.7894853  0.8213235  0.5895238
  9  0.7808088  0.8095588  0.6285714

ROC was used to select the optimal model using the largest value.
The final value used for the model was k = 5.</code></pre>
</div>
</div>
</section>
</section>
<section id="sec-linear-models" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="sec-linear-models"><span class="header-section-number">3.3</span> Modelos lineales</h2>
<p>Los modelos lineales asumen que existe una relación lineal entre las variables de entrada (<em>inputs</em>, <em>features</em>) y la salida que se desea predecir. Cuidado, porque esto no implica necesariamente que la forma de la función ajustada sea una línea recta, una confusión bastante común que suele asaltar a muchas personas.</p>
<p>El dos ejemplos muy básicos de este tipo de modelos son la regresión lineal simple y la regresión lineal múltiple, presentados en detalle en el <a href="https://bradleyboehmke.github.io/HOML/linear-regression.html">Capítulo 4</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>, así como en el Capítulo 3 de <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>. Sin embargo, un polinomio de grado (parábola) sigue siendo un modelo lineal ya que, aunque su forma son sea una línea recta, la ecuación se sigue expresando como una combinación lineal de varias componentes.</p>
<p>Los Modelos Lineales Generalizados (GLM por sus siglas en inglés) extienden el modelo lineal original para responder a muchos tipos de problemas: variables respuesta que no siguen una distribución normal, relaciones no lineales (no recta) entre las entradas y la variable de salida, o salidas de tipo categórico (binarias, multinomiales, ordenadas, etc.).</p>
<p>Este tipo de modelos consta de tres elementos <span class="citation" data-cites="agresti2015">(<a href="references.html#ref-agresti2015" role="doc-biblioref">Agresti, 2015</a>)</span>:</p>
<ul>
<li><p><strong>Función de enlace</strong>: define una conexión entre el valor esperado (media) de la variable respuesta con la combinación lineal de las variables de entrada, lo que permite definir modelos que no sigan la forma de una recta (más flexibles), capturando relaciones más complejas.</p></li>
<li><p><strong>Distribución de probabilidad</strong> (componente aleatoria): describe el “ruido” o variabilidad de los datos alrededor del valor promedio que se predice. Distribuciones habituales son la Normal, Binomial o Poisson.</p></li>
<li><p><strong>Estructura lineal</strong>: todas las variables de entrada se relacionan entre sí mediante una combinación lineal, ponderadas por coeficientes que se ajustan a partir de los datos de entrenamiento. Sin embargo, la estructura generalizada del modelo permite asumir formas no lineales, así como incorporar variables de entrada categóricas, mediante la codificación adecuada.</p></li>
</ul>
<p>La <a href="#tbl-my" class="quarto-xref">Tabla&nbsp;<span>3.3</span></a> presenta algunos modelos GLM frecuentemente empleados.</p>
<div id="tbl-my" class="striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-my-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;3.3: Algunos modelos GLM y sus elementos constitutivos asociados.
</figcaption>
<div aria-describedby="tbl-my-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 24%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Modelo</th>
<th style="text-align: left;">Comp. aleatoria</th>
<th style="text-align: left;">Col3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Regresión lineal</td>
<td style="text-align: left;">Normal</td>
<td style="text-align: left;">Cuantitativas o cualitativas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Regresión logística</td>
<td style="text-align: left;">Binomial</td>
<td style="text-align: left;">Cuantitativas o cualitativas</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LogLinear</td>
<td style="text-align: left;">Poisson</td>
<td style="text-align: left;">Cualitativas</td>
</tr>
<tr class="even">
<td style="text-align: left;">Reg. de Poisson</td>
<td style="text-align: left;">Poisson</td>
<td style="text-align: left;">Cuantitativas o cualitativas</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="ajuste-de-un-modelo-de-clasificación-lr" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="ajuste-de-un-modelo-de-clasificación-lr"><span class="header-section-number">3.3.1</span> Ajuste de un modelo de clasificación LR</h3>
<p>Seguidamente, se presenta el proceso de ajuste y evaluación de un modelo de clasificación mediante regresión logística (LR). Este modelo estima una probabilidad a la salida y debemos establecer un umbral o <em>threshold</em> para dicha probabilidad estimada, a partir de cual (para valores superiores o iguales) asignamos una de las dos posibles etiquetas de salida (por ejemplo, <code>1</code>). Para una probabilidad estimada menor que el umbral asignamos la otra posible etiqueta de salida (por ejemplo, <code>0</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresión logística</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>model_glm <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  Class <span class="sc">~</span> .,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> training,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"ROC"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> config_control</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>model_glm</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

157 samples
  9 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 125, 126, 126, 125, 126 
Resampling results:

  ROC        Sens       Spec     
  0.8034314  0.7610294  0.7828571</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recuperamos los coeficientes del modelo final ajustado</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_glm<span class="sc">$</span>finalModel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
NULL

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.4778     1.5031   1.648 0.099268 .  
V1          -17.1009    12.1553  -1.407 0.159466    
V11          -8.2378     2.3484  -3.508 0.000452 ***
V17           2.3566     1.0500   2.244 0.024808 *  
V23          -2.3698     1.0091  -2.348 0.018859 *  
V28           0.4797     0.9750   0.492 0.622699    
V34           2.0068     1.0909   1.840 0.065818 .  
V40           3.3099     1.5339   2.158 0.030933 *  
V45          -8.4562     2.1913  -3.859 0.000114 ***
V56         -42.1597    42.1564  -1.000 0.317273    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 216.88  on 156  degrees of freedom
Residual deviance: 144.85  on 147  degrees of freedom
AIC: 164.85

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="regularización-en-modelos-lineales" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="regularización-en-modelos-lineales"><span class="header-section-number">3.3.2</span> Regularización en modelos lineales</h3>
<p>En los conjuntos de datos actuales, normalmente de gran tamaño, existe el riesgo de que los modelos lineales tiendan al sobreajuste de los datos de entrenamiento, incrementando nuestro error de generalización. Una estrategia muy útil para restringir este efecto pernicioso es la <strong>regularización</strong> del modelo, que consiste en aplicar una serie de “penalizaciones” a los coeficientes estimados para reducir la varianza (dentro del compromiso varianza-sesgo) y así mantener a raya el problema del sobreajuste.</p>
<p>Tres opciones muy comunes de regularización son:</p>
<ul>
<li><p>Penalización Ridge: modifica la función objetivo de ajuste del modelo con un término controlado por un hiperparámetro <span class="math inline">\(\lambda\)</span>. Cuanto más crece el valor asignado a <span class="math inline">\(\lambda\)</span> más se fuerza a que los coeficientes del modelo se vayan haciendo cada vez más pequeños, aunque sin llegar a anularse. Véase el <a href="https://bradleyboehmke.github.io/HOML/regularized-regression.html#why">Apartado 6.2.1</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>.</p></li>
<li><p>Penalización Lasso: altera la función objetivo para ajustar el modelo con un térmio también controlado por un hiperparámetro <span class="math inline">\(\lambda\)</span>. Sin embargo, al contrario que en el caso anterior, cuando <span class="math inline">\(\lambda\)</span> crece se van anulando progresivamente más coeficientes de la función de predicción, lo que constituye un método más drástico de selección de variables y simplificación de nuestro modelo. Véase el <a href="https://bradleyboehmke.github.io/HOML/regularized-regression.html#why">Apartado 6.2.2</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>.</p></li>
<li><p><em>Elastic net</em>: es una solución intermedia entre los dos casos anteriores, introduciendo simultáneamente ambos tipos de penalización (Ridge y Lasso), cada uno de ellos controlado por un hiperparámetro de penalización, <span class="math inline">\(\lambda_1\)</span> y <span class="math inline">\(\lambda_2\)</span>, respectivamente. Véase el <a href="https://bradleyboehmke.github.io/HOML/regularized-regression.html#why">Apartado 6.2.3</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>.</p></li>
</ul>
<p>En la <a href="#fig-ridge-lasso-contours" class="quarto-xref">Figura&nbsp;<span>3.2</span></a> se representan los errores (todos los puntos sobre una elipse tienen el mismo valor de RSS) y las funciones de restricción impuestas en el caso de la penalización Lasso y Ridge. Podemos observar como en el caso del Lasso las restricciones tienen aristas, lo que hace que la intersección entre el contorno y la región de restricción se produzca sobre el eje. Cuando esto ocurre, los coeficientes de la función de regresión se anulan. Sin embargo, en Ridge el punto de intersección no llega a tocar el eje, por lo que los coeficientes no llegan a anularse.</p>
<div id="fig-ridge-lasso-contours" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ridge-lasso-contours-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/ridge-lasso-contours.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ridge-lasso-contours-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.2: Gráficos de contorno para los errores en las estimaciones y funciones de restricción para Lasso (izq.) y Ridge (dcha.). Fuente: Fig. 6.7 <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="extensiones-del-modelo-lineal" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="extensiones-del-modelo-lineal"><span class="header-section-number">3.4</span> Extensiones del modelo lineal</h2>
<p>Además de los modelos polinómicos o los GLM descritos anteriormente, existen más extensiones de los modelos lineales. La aproximación común a muchos de ellos es utilizar funciones polinómicas con formas suaves para ir ajustando tramos de la función de predicción. En consecuencia, la superposición (combinación lineal) de estas funciones suaves dará como resultado un modelo tremendamente flexible que se puede adaptar a problemas muy complicados.</p>
<p>Un primer ejemplo son los modelos MARS (<em>Multivariate Adaptive Regression Splines</em>), presentados en el <a href="https://bradleyboehmke.github.io/HOML/mars.html#the-basic-idea">Capítulo 7</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>. Otro ejemplo son los modelos GAM (<em>Generalized Additive Models</em>) que se explican en la Sección 7.7 de <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>. En el caso de estos últimos se extiende el modelo lineal manteniendo la combinación aditiva (suma) de los componentes de predicción. Sin embargo, en cada componente se emplea una función lineal <span class="math inline">\(f_j(x_{ij})\)</span>, cuya forma debemos estimar a partir de los datos, según la <a href="#eq-GAM" class="quarto-xref">Ecuación&nbsp;<span>3.3</span></a>:</p>
<p><span id="eq-GAM"><span class="math display">\[
y_i = \beta_0 + \sum_{j=1}^{p}f_j(x_{ij})+\epsilon_i
\tag{3.3}\]</span></span></p>
<p>La <a href="#fig-example-GAM-fit" class="quarto-xref">Figura&nbsp;<span>3.3</span></a> muestra un ejemplo del resultado de ajustar un modelo GAM utilizando dos variables de entrada cuantitativas y una cualitativa.</p>
<div id="fig-example-GAM-fit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example-GAM-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/example-GAM-fit.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example-GAM-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.3: Ejemplo de ajuste de un modelo GAM, con dos predictores cuantitativos (izq. y centro) y otro cualitativo (dcha.). Se puede apreciar que las funciones para los predictores cuantiativos son flexibles y suaves. Fuente: Fig. 7.12 <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>.
</figcaption>
</figure>
</div>
<section id="ajuste-de-un-modelo-gam-para-clasificación" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="ajuste-de-un-modelo-gam-para-clasificación"><span class="header-section-number">3.4.1</span> Ajuste de un modelo GAM para clasificación</h3>
<p>Los modelos GAM pueden aplicarse tanto a problemas de regresión como de clasificación. En el paquete <code>caret</code>, podemos escoger ajustar un modelo de este tipo con el paquete <code>mgcv</code> o bien con el paquete <code>gam</code>.</p>
<p>En este caso, podremos ver que la función de enlace (<em>link function</em>) establecida para relacionar la salida con la combinación lineal de los regresores es <em>logit</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model_gam_mgcv <span class="ot">=</span> <span class="fu">train</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>training, <span class="at">method=</span><span class="st">'gam'</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric=</span><span class="st">"ROC"</span>, <span class="at">trControl =</span> config_control)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>model_gam_mgcv</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Additive Model using Splines 

157 samples
  9 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 125, 126, 126, 125, 126 
Resampling results across tuning parameters:

  select  ROC        Sens       Spec     
  FALSE   0.7728817  0.8095588  0.6171429
   TRUE   0.7928011  0.7500000  0.7266667

Tuning parameter 'method' was held constant at a value of GCV.Cp
ROC was used to select the optimal model using the largest value.
The final values used for the model were select = TRUE and method = GCV.Cp.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_gam_mgcv<span class="sc">$</span>finalModel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: binomial 
Link function: logit 

Formula:
.outcome ~ s(V56) + s(V1) + s(V23) + s(V28) + s(V17) + s(V11) + 
    s(V34) + s(V40) + s(V45)

Parametric coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)  -0.3515     0.2604   -1.35    0.177

Approximate significance of smooth terms:
          edf Ref.df Chi.sq  p-value    
s(V56) 0.7416      9  1.815 0.108066    
s(V1)  0.7876      9  2.435 0.071601 .  
s(V23) 2.0615      9  7.979 0.009524 ** 
s(V28) 2.4275      9  7.407 0.020306 *  
s(V17) 1.7828      9  6.784 0.013827 *  
s(V11) 2.0751      9 16.218 5.11e-05 ***
s(V34) 3.8758      9 10.983 0.012560 *  
s(V40) 1.6428      9  3.822 0.074852 .  
s(V45) 1.0000      9 14.341 0.000108 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.548   Deviance explained = 53.3%
UBRE = -0.1328  Scale est. = 1         n = 157</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model_gam <span class="ot">=</span> <span class="fu">train</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>training, <span class="at">method=</span><span class="st">'gamSpline'</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric=</span><span class="st">"ROC"</span>, <span class="at">trControl =</span> config_control)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>model_gam</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Additive Model using Splines 

157 samples
  9 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 126, 125, 126, 125, 126 
Resampling results across tuning parameters:

  df  ROC        Sens       Spec     
  1   0.8047129  0.7639706  0.7295238
  2   0.8616597  0.8110294  0.7961905
  3   0.8607353  0.7992647  0.7676190

ROC was used to select the optimal model using the largest value.
The final value used for the model was df = 2.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model_gam<span class="sc">$</span>finalModel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) s(V56, df = 2)  s(V1, df = 2) s(V23, df = 2) s(V28, df = 2) 
      2.174201     -53.809688     -17.909083      -2.124357       0.518643 
s(V17, df = 2) s(V11, df = 2) s(V34, df = 2) s(V40, df = 2) s(V45, df = 2) 
      2.457338      -6.963477       2.165397       3.161222      -9.148652 </code></pre>
</div>
</div>
</section>
</section>
<section id="máquinas-de-vector-soporte-svm" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="máquinas-de-vector-soporte-svm"><span class="header-section-number">3.5</span> Máquinas de vector soporte (SVM)</h2>
<p>Las SVM son ejemplos de modelos de clasificación (salida cualitativa), en los que el objetivo es encontrar un hiperplano que separe de la mejor forma posible los elementos pertenecientes a dos grupos (asumiendo que la salida es una variable binaria).</p>
<p>La <a href="#fig-svm-hmc1" class="quarto-xref">Figura&nbsp;<span>3.4</span></a> muestra cómo se identifican los llamados “vectores soporte” para definir la frontera de separación entre los puntos pertenecientes a los dos grupos de la variable de salida, para el caso de un clasficador de margen rígido (es decir, que no admite que puntos de uno de los grupos desborden la frontera con el otro grupo).</p>
<div id="fig-svm-hmc1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-svm-hmc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/svm-hmc-1.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-svm-hmc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.4: Ilustración del método para encontrar los vectores soporte, que definen la frontera de separación entre los dos grupos de la variable de salida en un modelo SVM. Se asume un clasficador de margen rígido (HMC). Fuente: Fig. 14.3 <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>.
</figcaption>
</figure>
</div>
<p>Lo normal es utilizar una versión más flexible de este algoritmo, que tolera que existan puntos mal clasificados (i.e.&nbsp;en el lado incorrecto de la frontera), dentro de un cierto margen de error. No obstante, la verdadera clave de estos modelos es que aplican el llamado <strong><em>kernel trick</em></strong>, una argucia matemática que nos permite representar los datos en un espacio alternativo en el que la separación entre las fronteras sea calculable. Matemáticamente, entender esta herramienta implica el manejo de <em>funciones núcleo</em> (<em>kernel functions</em>) y comprender los Espacios de Hilbert de Núcleo Reproductor (RKHS). Puedes consultar estos <a href="https://www.gatsby.ucl.ac.uk/~gretton/coursefiles/lecture4_introToRKHS.pdf">apuntes de un profesor de UCL</a> para una introducción a estos temas.</p>
<p>En la práctica, el hecho de que no podamos apreciar directamente los detalles del espacio alternativo en el que se están representando los datos hace que a estos modelos se les considere en cierta medida como de “caja negra” (<em>black-box models</em>). En consecuencia, otras de las limitaciones es que no resulta nada evidente explicar el papel que juega cada una de las variables en la identificación de la frontera de separación entre clases.</p>
<div id="fig-two-spirals-SVM" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-two-spirals-SVM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/two-spirals-SVM.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-two-spirals-SVM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.5: Fronteras de separación entre dos grupos de datos que se organizan en forma de espiral. Izq.: frontera de clasificación determinada mediante un algoritmo RF. Dcha.: frontera de clasificación identificada mediante un algoritmo SVM que usa una función núcleo de base radial (<em>radial basis kernel</em>). Fuente: Fig. 14.7 <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>.
</figcaption>
</figure>
</div>
<section id="ajuste-de-un-modelo-svm-rbf" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="ajuste-de-un-modelo-svm-rbf"><span class="header-section-number">3.5.1</span> Ajuste de un modelo SVM (RBF)</h3>
<p>Mostramos un ejemplo de cómo entrenar un modelo SVM, utilizando como función <em>kernel</em> la función de base radial (<em>Radial Basis Function</em>). Los hiperparámetros que controlan la complejidad del modelo son <code>sigma</code> y <code>C</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model_svmRadial <span class="ot">=</span> <span class="fu">train</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>training, <span class="at">method=</span><span class="st">'svmRadial'</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">metric=</span><span class="st">"ROC"</span>, <span class="at">tuneLength=</span><span class="dv">15</span>, <span class="at">trControl =</span> config_control)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>model_svmRadial</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Support Vector Machines with Radial Basis Function Kernel 

157 samples
  9 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 125, 125, 127, 125, 126 
Resampling results across tuning parameters:

  C        ROC        Sens       Spec     
     0.25  0.8440616  0.8441176  0.7104762
     0.50  0.8624300  0.8316176  0.7095238
     1.00  0.8698669  0.8323529  0.7371429
     2.00  0.8789391  0.8198529  0.7514286
     4.00  0.8760784  0.8198529  0.7390476
     8.00  0.8634139  0.8198529  0.7657143
    16.00  0.8351225  0.8198529  0.7257143
    32.00  0.8435609  0.8080882  0.7123810
    64.00  0.8480917  0.7705882  0.7266667
   128.00  0.8480917  0.8308824  0.6990476
   256.00  0.8480917  0.7955882  0.7123810
   512.00  0.8480917  0.7955882  0.6990476
  1024.00  0.8480917  0.7955882  0.6990476
  2048.00  0.8480917  0.7838235  0.6980952
  4096.00  0.8480917  0.8191176  0.6990476

Tuning parameter 'sigma' was held constant at a value of 0.07543981
ROC was used to select the optimal model using the largest value.
The final values used for the model were sigma = 0.07543981 and C = 2.</code></pre>
</div>
</div>
</section>
</section>
<section id="modelos-probabilísticos-naïve-bayes" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="modelos-probabilísticos-naïve-bayes"><span class="header-section-number">3.6</span> Modelos probabilísticos: Naïve Bayes</h2>
<p>Un ejemplo de modelos de clasificación probabilísticos es el llamado Naïve Bayes (Bayes ingenuo), cuyo funcionamiento se basa en una aplicación directa del Teorema de Bayes. Se emplean con frecuencia en problemas de clasificación con datos textuales, cuando tenemos muchas variables de entrada o bien cuando el rango de valores de las variables de entrada es muy amplio.</p>
<p>Recordemos que el Teorema de Bayes viene dado por:</p>
<p><span id="eq-Bayes-theorem"><span class="math display">\[
P(B \mid A) = \frac{P(B)P(A \mid B)}{P(A)}
\tag{3.4}\]</span></span></p>
<p>Si consideramos que las variables predictoras son independientes entre sí, entonces tenemos que la fórmula de predicción es:</p>
<p><span id="eq-Naive-Bayes"><span class="math display">\[
P(Y_k \mid X_1, \dots, X_p) = \frac{P(Y_k)\prod_{j=1}^p P(X_j \mid Y_k)}{P(X_1, X_2, \dots, X_p)}
\tag{3.5}\]</span></span></p>
<p>Puesto que el denominador es una constante, nos centramos en calcular el valor del numerador para poder comparar las probabilidades condicionadas a los valores de las variables de entrada. La clase predicha maximiza la expresión:</p>
<p><span class="math display">\[
\underset{x}{\arg\max} \left\{ P(Y_k) \prod_{j=1}^p P(X_j \mid Y_k)\right\}.
\]</span></p>
</section>
<section id="redes-neuronales-y-aprendizaje-profundo" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="redes-neuronales-y-aprendizaje-profundo"><span class="header-section-number">3.7</span> Redes neuronales y aprendizaje profundo</h2>
<p>Muchos modelos de aprendizaje automático solamente incorporan una o dos capas de transformación de datos para aprender la representación de los datos de salida. Estos modelos se denominan superficiales (<em>shallow models</em>). En contraste, los <strong>modelos profundos</strong> (<em>deep models</em>) siguen una aproximación multicapa para aprender las representaciones de los datos. El caso más habitual es el de usar múltiples capas de <strong>redes neuronales</strong>. El <a href="https://bradleyboehmke.github.io/HOML/deep-learning.html">Capítulo 13</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span> y el Capítulo 10 de <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span> proporcionan dos buenas introducciones a este tipo de modelos.</p>
<p>La <a href="#fig-multi-layer-NN" class="quarto-xref">Figura&nbsp;<span>3.6</span></a> muestra el diseño de una red neuronal con dos capas ocultas que podría utilizarse para predecir los 10 posibles valores de salida del dataset MNIST, con imágenes de cifras manuscritas.</p>
<div id="fig-multi-layer-NN" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-multi-layer-NN-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/multi-layer-NN.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multi-layer-NN-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.6: Esquema de un modelo de clasificación basado en una red neuronal con dos capas ocultas y varias posibles salidas, que se puede aplicar al conjunto de datos MNIST de cifras manuscritas. Fuente: Fig. 10.4 <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>.
</figcaption>
</figure>
</div>
<p>La clave para que una red neuronal de aprendizaje profundo se autoajuste en base a los datos de entrenamiento es un proceso denominado <strong>retropropagación</strong> (<em>backpropagation</em>). Este proceso se explica, por ejemplo, en la <a href="https://bradleyboehmke.github.io/HOML/deep-learning.html#dl-back">Sec. 13.5</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>, así como en la Sec. 10.7.1 de <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>, entre otras muchas fuentes.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Videotutorial sobre aprendizaje profundo
</div>
</div>
<div class="callout-body-container callout-body">
<p>El sitio web <a href="https://www.3blue1brown.com/" class="uri">https://www.3blue1brown.com/</a> contiene un extenso catálogo de videotutoriales y sesiones formativas sobrfe muchos temas de interés, como redes neuronales, álgebra o cálculo.</p>
<p>El vídeo <a href="https://www.3blue1brown.com/?v=backpropagation">What is backpropagation really doing?</a> es una de las mejores explicaciones intuitivas para entender mejor el papel de la retropropagación en el entrenamiento de redes neuronales para aprendizaje profundo.</p>
</div>
</div>
</section>
<section id="ensamblado-de-modelos" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="ensamblado-de-modelos"><span class="header-section-number">3.8</span> Ensamblado de modelos</h2>
<p>El ensamblado de modelos es una aproximación para resolver el problema del aprendizaje máquina que consiste en combinar la salida de múltiples modelos individuales para dar una predicción final que mejora el rendimiento que podríamos alcanzar con un solo modelo. La referencia más completa para entender bien esta estrategia de aprendizaje máquina es <span class="citation" data-cites="kuncheva2014">(<a href="references.html#ref-kuncheva2014" role="doc-biblioref">Kuncheva, 2014</a>)</span>.</p>
<p>Algunos de los modelos más conocidos son:</p>
<ul>
<li><p><em>Bagging</em> (<em>Bootstrap AGGregatING): consiste en el ensamblado de modelos de clasificación entrenados sobre réplicas </em>bootstrap* de los datos de entrenamiento originales. La salida de los clasificadores individuales se combina mediante el voto de pluralidad. Utilizar el voto mayoritario para tomar la decisión garantiza que vamos a obtener un resultado que mejora el de cada modelo individual. El <a href="https://bradleyboehmke.github.io/HOML/bagging.html">Capítulo 10</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span> muestra en detalle ejemplos de esta técnica.</p></li>
<li><p><em>Random Forests</em> (bosques aleatorios): fueron propuestos por el insigne Leo Breiman en 2001 <span class="citation" data-cites="breiman2001random">(<a href="references.html#ref-breiman2001random" role="doc-biblioref">Breiman, 2001</a>)</span>. Es una modificación de la estrategia de <em>bagging</em> aplicada a modelos de árboles de decisión, que emplea una amplia colección de árboles <em>decorrelados entre sí</em> para mejorar la eficiencia de predicción de la variable de salida. Además de tomar muestras <em>bootstrap</em> de los datos de entrenamiento, este método realiza selecciones aleatorias de las variables de entrada <em>en cada nodo del árbol</em>, tras lo cual se selecciona de entre las características tomadas la azar la mejor para dividir los caminos desde ese nodo. Es uno de los métodos más populares hoy en día, puesto que ofrece un buen rendimiento con un coste computacional contenido y con relativamente poco esfuerzo de ajuste de hiperparámetros. El <a href="https://bradleyboehmke.github.io/HOML/random-forest.html">Capítulo 11</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span> muestra el trabajo con este tipo de algoritmos.</p></li>
<li><p><em>Boosting</em>: propone la construcción de un ensamblado de árboles poco profundos, secuencialmente, en el que cada árbol que se añade mejora al anterior. Aunque cada árbol poco profundo es una herramienta de aprendizaje débil, pueden ser “potenciados” (<em>boosted</em>) de este modo para crear un comité de modelos que ofrece un rendimiento muy bueno. Uno de los primeros métodos propuestos con esta estrategia fue AdaBoost. Una de las variantes más populares actualmente es XGBoost (<em>Extreme Gradient Boosting</em>) (véase <a href="https://bradleyboehmke.github.io/HOML/gbm.html#xgboost">Sec. 12.5</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>), que incluye hiperparámetros para controlar términos de penalización del modelo que reduzcan su complejidad y prevengan el sobreajuste.</p></li>
</ul>
<section id="ejemplo-de-ajuste-de-un-modelo-random-forests-rf" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="ejemplo-de-ajuste-de-un-modelo-random-forests-rf"><span class="header-section-number">3.8.1</span> Ejemplo de ajuste de un modelo Random Forests (RF)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model_rf <span class="ot">=</span> <span class="fu">train</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>training, <span class="at">method=</span><span class="st">'rf'</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric=</span><span class="st">"ROC"</span>, <span class="at">tuneLength=</span><span class="dv">5</span>, <span class="at">trControl =</span> config_control)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>model_rf</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

157 samples
  9 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 125, 127, 125, 126, 125 
Resampling results across tuning parameters:

  mtry  ROC        Sens       Spec     
  2     0.8592857  0.8330882  0.7942857
  3     0.8732826  0.7970588  0.7809524
  5     0.8693452  0.8323529  0.7809524
  7     0.8782143  0.8323529  0.7942857
  9     0.8717192  0.8088235  0.7800000

ROC was used to select the optimal model using the largest value.
The final value used for the model was mtry = 7.</code></pre>
</div>
</div>
</section>
<section id="ejemplo-de-ajuste-de-un-modelo-adaboost" class="level3" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="ejemplo-de-ajuste-de-un-modelo-adaboost"><span class="header-section-number">3.8.2</span> Ejemplo de ajuste de un modelo AdaBoost</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model_adaboost <span class="ot">=</span> <span class="fu">train</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>training, <span class="at">method=</span><span class="st">'AdaBoost.M1'</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">metric=</span><span class="st">"ROC"</span>, <span class="at">tuneLength=</span><span class="dv">2</span>, <span class="at">trControl =</span> config_control)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>model_adaboost</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AdaBoost.M1 

157 samples
  9 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 125, 126, 125, 126, 126 
Resampling results across tuning parameters:

  coeflearn  maxdepth  mfinal  ROC        Sens       Spec     
  Breiman    1          50     0.8149160  0.7735294  0.6571429
  Breiman    1         100     0.8295518  0.7963235  0.7266667
  Breiman    2          50     0.8341527  0.7852941  0.7400000
  Breiman    2         100     0.8396429  0.7970588  0.7257143
  Freund     1          50     0.8370448  0.7852941  0.7247619
  Freund     1         100     0.8375700  0.7970588  0.7523810
  Freund     2          50     0.8490966  0.7500000  0.7114286
  Freund     2         100     0.8391246  0.7970588  0.6980952
  Zhu        1          50     0.8489286  0.7375000  0.7390476
  Zhu        1         100     0.8407633  0.7382353  0.7390476
  Zhu        2          50     0.8560364  0.8102941  0.7523810
  Zhu        2         100     0.8264146  0.7742647  0.7228571

ROC was used to select the optimal model using the largest value.
The final values used for the model were mfinal = 50, maxdepth = 2
 and coeflearn = Zhu.</code></pre>
</div>
</div>
</section>
<section id="ejemplo-de-ajuste-de-modelos-xgboost" class="level3" data-number="3.8.3">
<h3 data-number="3.8.3" class="anchored" data-anchor-id="ejemplo-de-ajuste-de-modelos-xgboost"><span class="header-section-number">3.8.3</span> Ejemplo de ajuste de modelos XGBoost</h3>
<p><strong>XGBoost lineal</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model_xgbLinear <span class="ot">=</span> <span class="fu">train</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>training, <span class="at">method=</span><span class="st">'xgbLinear'</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">metric=</span><span class="st">"ROC"</span>, <span class="at">tuneLength=</span><span class="dv">5</span>, <span class="at">trControl =</span> config_control, <span class="at">verbose=</span>F)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Descomentar para ver iteraciones</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model_xgbLinear</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="apilado-de-modelos" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="apilado-de-modelos"><span class="header-section-number">3.9</span> Apilado de modelos</h2>
<p>Por último, otra posible estrategia de combinación de modelos de aprendizaje individuales es el <strong>apilado de modelos</strong> (<em>model stacking</em>), que implica el entrenamiento de un nuevo modelo que combina las predicciones de varios modelos de aprendizaje de base. El meta-algoritmo que combina las salidas previas, llamado <em>super learner</em> permite mejorar aún más el rendimiento de los modelos de aprendizaje de base (como RF o XGBoost). En el <a href="https://bradleyboehmke.github.io/HOML/stacking.html">Capítulo 15</a> de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span> se puede encontrar más información y ejemplos de este tipo de modelos.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-agresti2015" class="csl-entry" role="listitem">
Agresti, A. (2015). <em><span>Foundations of Linear and Generalized Linear Models</span></em> (1.ª ed.). John Wiley &amp; Sons.
</div>
<div id="ref-UCI1998" class="csl-entry" role="listitem">
Blake, C. L., &amp; Merz, C. J. (1998). <em>UCI Repository of Machine Learning Databases</em>. University of California, Irvine, Department of Information; Computer Sciences.
</div>
<div id="ref-boehmke2019" class="csl-entry" role="listitem">
Boehmke, B., &amp; Greenwell, B. (2019). <em>Hands-On Machine Learning with R</em> (1.ª ed.). Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9780367816377">https://doi.org/10.1201/9780367816377</a>
</div>
<div id="ref-breiman2001random" class="csl-entry" role="listitem">
Breiman, L. (2001). Random forests. <em>Machine learning</em>, <em>45</em>(1), 5-32.
</div>
<div id="ref-gorman1988" class="csl-entry" role="listitem">
Gorman, R. P., &amp; Sejnowski, T. J. (1988). Analysis of Hidden Units in a Layered Network Trained to Classify Sonar Targets. <em>Neural Networks</em>, <em>1</em>, 75-89. <a href="https://doi.org/10.1016/0893-6080(88)90023">https://doi.org/10.1016/0893-6080(88)90023</a>
</div>
<div id="ref-james2021" class="csl-entry" role="listitem">
James, W., G. (2021). <em><span>An Introduction to Statistical Learning with Applications in R</span></em> (2.ª ed.). Springer. <a href="https://www.statlearning.com/">https://www.statlearning.com/</a>
</div>
<div id="ref-kuncheva2014" class="csl-entry" role="listitem">
Kuncheva, L. I. (2014). <em>Combining Pattern Classifiers: Methods and Algorithms</em> (2.ª ed.). Wiley-Interscience. <a href="https://lucykuncheva.co.uk/Combining_Pattern_Classifiers_Methods_and_Algorithms_2nd_ed_Kuncheva%202014-09-09.pdf">https://lucykuncheva.co.uk/Combining_Pattern_Classifiers_Methods_and_Algorithms_2nd_ed_Kuncheva%202014-09-09.pdf</a>
</div>
<div id="ref-leisch2024mlbench" class="csl-entry" role="listitem">
Leisch, F., &amp; Dimitriadou, E. (2024). <em>mlbench: Machine Learning Benchmark Problems</em>. <a href="https://CRAN.R-project.org/package=mlbench">https://CRAN.R-project.org/package=mlbench</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-ml-supervisado.html" class="pagination-link" aria-label="Aprendizaje máquina supervisado">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Aprendizaje máquina supervisado</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-seleccion-validacion.html" class="pagination-link" aria-label="Selección y validación de modelos">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Selección y validación de modelos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>